<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#ùòøùôñùô°ùôûùôñùô©ùôûùô¢ùôöùôíùôßùôñùô•ùô•ùôöùôô : popculture</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Comfortaa:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            color: #FFFFFF;
            padding-bottom: 80px; /* Added back for footer */
            /* Frutiger Aero inspired gradient */
            background: radial-gradient(at top left, #2B78BF 0%, #1A1A1A 50%, #60D394 100%), 
                        linear-gradient(135deg, #1A1A1A 0%, #2B78BF 70%, #60D394 100%);
            background-blend-mode: multiply;
            background-attachment: fixed;
            background-size: cover;
        }
        .spotify-green { color: #60D394; }
        .spotify-pink { color: #B5CBEB; }
        .spotify-blue { color: #2B78BF; }
        .spotify-yellow { color: #F7E598; }

        .bg-spotify-dark { background-color: transparent; }
        
        /* Glassmorphism for panels */
        .bg-spotify-card {
            background-color: rgba(40, 40, 40, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 0.5rem;
            padding: 1.5rem;
        }

        .header-glow {
            text-shadow: 0 0 8px rgba(96, 211, 148, 0.7), 0 0 10px rgba(96, 211, 148, 0.5);
        }
        .stat-number {
            font-weight: 900;
            font-size: 3.5rem;
            line-height: 1.1;
            display: inline-block; /* To allow transform on span */
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .stat-number.is-visible {
            opacity: 1;
            transform: translateX(0);
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; /* Adjusted max-width to be slightly smaller for better fit */
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        .timeline {
            position: relative;
            padding: 2rem 0;
        }
        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background-color: #60D394;
            opacity: 0.3;
        }
        .timeline-item {
            position: relative;
            width: 50%;
            padding: 1rem 2rem;
            box-sizing: border-box;
            opacity: 0; /* Initial state for animation */
            transform: translateY(20px); /* Initial state for animation */
            transition: opacity 0.8s ease-out, transform 0.8s ease-out; /* Transition properties */
        }
        .timeline-item.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .timeline-item:nth-child(odd) {
            left: 0;
            padding-right: 4rem;
            text-align: right;
        }
        .timeline-item:nth-child(even) {
            left: 50%;
            padding-left: 4rem;
            text-align: left;
        }
        .timeline-dot {
            content: '';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #60D394;
            border: 4px solid #1A1A1A;
        }
        .timeline-item:nth-child(odd) .timeline-dot {
            right: -10px;
        }
        .timeline-item:nth-child(even) .timeline-dot {
            left: -10px;
        }
        .flowchart-node {
            border: 2px solid #60D394;
            background-color: rgba(40, 40, 40, 0.6);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            width: 200px; /* Fixed width for uniformity */
            height: 120px; /* Fixed height for uniformity */
            display: flex; /* Use flexbox for vertical centering */
            flex-direction: column;
            justify-content: center;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            opacity: 0; /* Initial state for animation */
            transition: opacity 0.8s ease-out, transform 0.8s ease-out; /* Transition properties */
        }
        /* Specific animations for flowchart nodes */
        .flowchart-node.slide-from-left {
            transform: translateX(-100px);
        }
        .flowchart-node.slide-from-right {
            transform: translateX(100px);
        }
        .flowchart-node.scale-in-center { /* Changed class name to avoid conflict */
            transform: scale(0.8);
        }

        .flowchart-node.is-visible {
            opacity: 1;
            transform: translateX(0) scale(1); /* Reset to original position/scale */
        }
        .flowchart-arrow {
            font-size: 2rem;
            color: #60D394;
            margin: 0 1rem;
            align-self: center;
        }
        /* Removed fixed-nav-bottom and back-button CSS */

        /* Comfortaa font for headers */
        h1, h2 {
            font-family: 'Comfortaa', cursive;
        }
    </style>
</head>
<body class="bg-spotify-dark">

    <header class="text-center p-8 md:p-16">
        <h1 class="text-4xl md:text-6xl font-black mb-2 header-glow">DALIATIME</h1>
        <h2 class="text-2xl md:text-4xl font-bold spotify-green">POP CULTURE WRAPPED</h2>
        <p class="text-lg text-gray-400 mt-2">Your recap of Dec 2023 - June 2025</p>
    </header>

    <main class="container mx-auto px-4">

        <section id="global-hits" class="py-12">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8"><span class="spotify-pink">Global Hits:</span> The World's Top Tracks</h2>
            <p class="text-center max-w-3xl mx-auto text-gray-300 mb-12">
                From viral trends to paradigm shifts, these were the cultural phenomena that defined the global conversation during Daliatime.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8">
                <div class="bg-spotify-card rounded-lg shadow-lg p-6 flex flex-col justify-center items-center">
                    <h3 class="text-2xl font-bold mb-4 text-center">The Creator Economy Boom</h3>
                    <p class="stat-number spotify-green"><span data-animate="stat-number">$16B</span></p>
                    <p class="text-center text-gray-400 mt-2">Estimated value of the influencer market, a testament to the shift from traditional media to individual creators.</p>
                </div>

                <div class="bg-spotify-card rounded-lg shadow-lg p-6 chart-section" data-chart-id="engagementRateChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">Micro-Influencer Engagement</h3>
                    <div class="chart-container">
                        <canvas id="engagementRateChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">This chart shows why authenticity wins. Micro-influencers drove significantly higher engagement rates, proving that genuine connection is more valuable than sheer follower count.</p>
                </div>

                <div class="bg-spotify-card rounded-lg shadow-lg p-6 md:col-span-2">
                    <h3 class="text-2xl font-bold mb-4 text-center">Nostalgia's Enduring Power</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                        <div>
                            <p class="text-5xl font-black spotify-blue"><span data-animate="stat-number">$70%</span></p>
                            <p class="mt-2 text-gray-400">Increase in searches for vintage aesthetics on Pinterest, fueling Y2K fashion revivals.</p>
                        </div>
                        <div>
                            <p class="text-5xl font-black spotify-blue"><span data-animate="stat-number">$300M</span></p>
                            <p class="mt-2 text-gray-400">Estimated value of Bob Dylan's catalog sale, highlighting music's timeless value.</p>
                        </div>
                        <div>
                            <p class="text-5xl font-black spotify-blue"><span data-animate="stat-number">50%</span></p>
                            <p class="mt-2 text-gray-400">of consumers cited nostalgia as a factor in their 2024 buying decisions.</p>
                        </div>
                    </div>
                </div>

                <div class="bg-spotify-card rounded-lg shadow-lg p-6 chart-section" data-chart-id="virtualConcertsChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">The Digital-Physical Fusion</h3>
                     <div class="chart-container">
                        <canvas id="virtualConcertsChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">Virtual concerts on platforms like Fortnite attracted millions, blurring the lines between online and offline social experiences.</p>
                </div>

                <div class="bg-spotify-card rounded-lg shadow-lg p-6 flex flex-col justify-center items-center">
                    <h3 class="text-2xl font-bold mb-4 text-center">Brand Purpose Resonates</h3>
                    <p class="stat-number spotify-pink"><span data-animate="stat-number">69%</span></p>
                    <p class="text-center text-gray-400 mt-2">Faster growth of Unilever's "Sustainable Living Brands," proving that consumers increasingly support companies committed to positive environmental impact.</p>
                </div>
            </div>
        </section>

        <section id="regional-rhythms" class="py-12">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8"><span class="spotify-yellow">Regional Rhythms:</span> Spotlights on SK & PH</h2>
            <p class="text-center max-w-3xl mx-auto text-gray-300 mb-12">
                While global trends set the beat, South Korea and the Philippines grooved to their own unique rhythms, exporting their culture to the world stage.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-spotify-card rounded-lg shadow-lg p-6 md:col-span-2 chart-section" data-chart-id="hallyuWaveChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">The Hallyu Wave's Global Reach</h3>
                     <div class="chart-container h-[450px] max-h-[500px]">
                        <canvas id="hallyuWaveChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">The Korean Wave showed nuanced global appeal. This chart illustrates which facet of Hallyu resonated most in different countries, from K-Pop in Southeast Asia to K-Food in the West.</p>
                </div>

                <div class="bg-spotify-card rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-bold mb-4 text-center">P-Pop's Rising Stardom</h3>
                    <div class="space-y-4">
                        <div class="text-center">
                            <p class="text-2xl font-bold">SB19</p>
                            <p class="text-gray-400">üèÜ Best Asia Act, MTV EMA</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">BINI</p>
                            <p class="text-gray-400">üé§ "Voices of Asia," Billboard</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">Alamat</p>
                            <p class="text-gray-400">üíÉ Fusing native sounds & dances</p>
                        </div>
                    </div>
                     <p class="text-center text-gray-400 mt-4">P-Pop groups gained significant international recognition, blending global pop aesthetics with distinct Filipino cultural pride.</p>
                </div>
                
                <div class="bg-spotify-card rounded-lg shadow-lg p-6 chart-section" data-chart-id="phStreamingChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">Philippine Streaming Market Growth</h3>
                    <div class="chart-container">
                        <canvas id="phStreamingChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">The Philippine streaming market saw explosive growth, with Netflix leading the charge by investing in local content, proving regional relevance drives engagement.</p>
                </div>
            </div>
        </section>

        <section id="tech-beat" class="py-12">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8"><span class="spotify-blue">The Tech Beat:</span> Innovations Shaping Culture</h2>
            <p class="text-center max-w-3xl mx-auto text-gray-300 mb-12">
                Technology was the underlying rhythm that propelled pop culture forward, with AI, immersive streaming, and the metaverse composing the soundtrack of our digital lives.
            </p>

            <div class="bg-spotify-card rounded-lg shadow-lg p-6 mb-8 flowchart-section">
                <h3 class="text-2xl font-bold mb-6 text-center">AI: The New Creative Partner</h3>
                <div class="flex flex-col md:flex-row justify-center items-center">
                    <div class="flowchart-node slide-from-left" data-animate="flowchart-node-simultaneous">
                        <p class="font-bold">Brainstorming & Scripting</p>
                        <p class="text-sm text-gray-400">AI tools assist writers</p>
                    </div>
                    <div class="flowchart-arrow hidden md:block">&rarr;</div>
                    <div class="flowchart-arrow md:hidden my-4">&darr;</div>
                    <div class="flowchart-node scale-in-center" data-animate="flowchart-node-simultaneous">
                        <p class="font-bold">Automated Post-Production</p>
                        <p class="text-sm text-gray-400">Agentic AI handles tedious tasks</p>
                    </div>
                    <div class="flowchart-arrow hidden md:block">&rarr;</div>
                    <div class="flowchart-arrow md:hidden my-4">&darr;</div>
                    <div class="flowchart-node slide-from-right" data-animate="flowchart-node-simultaneous">
                        <p class="font-bold">Hyper-Personalization</p>
                        <p class="text-sm text-gray-400">AI curates user experiences</p>
                    </div>
                </div>
                <p class="text-center text-gray-400 mt-6">AI transformed creative workflows, from initial idea generation to final content delivery, enabling greater efficiency and personalization across the entertainment industry.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-spotify-card rounded-lg shadow-lg p-6 chart-section" data-chart-id="metaverseMarketChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">The Metaverse Economy</h3>
                    <div class="chart-container">
                        <canvas id="metaverseMarketChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">The global metaverse market is projected to see astronomical growth, with e-commerce, virtual learning, and gaming set to be the biggest beneficiaries.</p>
                </div>
                <div class="bg-spotify-card rounded-lg shadow-lg p-6 chart-section" data-chart-id="consumerValuesChart">
                    <h3 class="text-2xl font-bold mb-4 text-center">The Shift in Consumer Values</h3>
                    <div class="chart-container">
                        <canvas id="consumerValuesChart"></canvas>
                    </div>
                    <p class="text-center text-gray-400 mt-4">Consumers, especially Gen Z, are prioritizing experiences over possessions and embracing sustainability, driving growth in the secondhand market and challenging fast fashion.</p>
                </div>
            </div>
        </section>
        
        <section id="viral-moments" class="py-12">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8"><span class="spotify-green">Viral Rewind:</span> Unforgettable Moments</h2>
            <p class="text-center max-w-3xl mx-auto text-gray-300 mb-12">
                A look back at the beefs, memes, and moments that had everyone talking.
            </p>
            <div class="timeline timeline-section">
                <div class="timeline-item" data-animate="timeline-item-simultaneous">
                    <div class="timeline-dot"></div>
                    <div class="p-4 bg-spotify-card rounded-lg shadow-lg">
                        <h4 class="font-bold text-lg spotify-pink">Kendrick vs. Drake</h4>
                        <p class="text-sm text-gray-400">The rap beef that dominated 2024, with "Not Like Us" becoming a viral anthem.</p>
                    </div>
                </div>
                <div class="timeline-item" data-animate="timeline-item-simultaneous">
                    <div class="timeline-dot"></div>
                    <div class="p-4 bg-spotify-card rounded-lg shadow-lg">
                        <h4 class="font-bold text-lg spotify-yellow">"Brat Summer"</h4>
                        <p class="text-sm text-gray-400">Charli XCX ushered in an era of hedonism, a sharp turn from "quiet luxury."</p>
                    </div>
                </div>
                <div class="timeline-item" data-animate="timeline-item-simultaneous">
                    <div class="timeline-dot"></div>
                    <div class="p-4 bg-spotify-card rounded-lg shadow-lg">
                        <h4 class="font-bold text-lg spotify-blue">Moo Deng the Hippo</h4>
                        <p class="text-sm text-gray-400">Thailand's baby pygmy hippo captured hearts worldwide with 500M+ TikTok views.</p>
                    </div>
                </div>
                <div class="timeline-item" data-animate="timeline-item-simultaneous">
                    <div class="timeline-dot"></div>
                    <div class="p-4 bg-spotify-card rounded-lg shadow-lg">
                        <h4 class="font-bold text-lg spotify-pink">"Wala po akong maalala"</h4>
                        <p class="text-sm text-gray-400">A viral meme in the Philippines sparked by a political controversy, reflecting public discourse.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-8 text-gray-500">
        <p>Daliatime Pop Culture Wrapped | 2023-2025</p>
        <p class="text-xs mt-2">Data synthesized from the "Daliatime Pop Culture Wrapped" analysis report.</p>
    </footer>

    <script>
        // Store references to Chart.js instances
        const charts = {};
        const chartsInitialized = {};

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const processLabels = (labels) => {
            return labels.map(label => {
                if (label.length > 16) {
                    const words = label.split(' ');
                    const newLabel = [];
                    let line = '';
                    words.forEach(word => {
                        if ((line + word).length > 16 && line.length > 0) {
                            newLabel.push(line.trim());
                            line = '';
                        }
                        line += word + ' ';
                    });
                    newLabel.push(line.trim());
                    return newLabel;
                }
                return label;
            });
        };
        
        const globalPlugins = {
            legend: {
                labels: {
                    color: '#FFFFFF'
                }
            },
            tooltip: {
                callbacks: {
                    title: tooltipTitleCallback
                }
            }
        };
        
        const globalScales = {
            y: {
                ticks: { color: '#FFFFFF', beginAtZero: true },
                grid: { color: 'rgba(255, 255, 255, 0.1)' }
            },
            x: {
                ticks: { color: '#FFFFFF' },
                grid: { color: 'rgba(255, 255, 255, 0.1)' }
            }
        };

        const pieDoughnutAnimation = {
            animateRotate: true,
            animateScale: true,
            duration: 1000,
            easing: 'easeInOutQuart'
        };

        // Chart creation functions
        function createEngagementRateChart() {
            // Destroy existing chart instance if it exists
            if (charts.engagementRateChart) {
                charts.engagementRateChart.destroy();
                charts.engagementRateChart = null;
            }
            const ctx = document.getElementById('engagementRateChart').getContext('2d');
            charts.engagementRateChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: processLabels(['Micro-Influencers (<15k followers)', 'Macro-Influencers (>1M followers)']),
                    datasets: [{
                        label: 'Engagement Rate (%)',
                        data: [3.86, 1.21],
                        backgroundColor: ['#60D394', '#B5CBEB'],
                        borderColor: ['#60D394', '#B5CBEB'],
                        borderWidth: 1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    indexAxis: 'y', // This makes it a horizontal bar chart
                    scales: {
                        x: { // Numerical scale for horizontal bars
                            min: 0, // Ensure it starts from 0
                            ticks: { color: '#FFFFFF' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: { // Categorical scale for horizontal bars
                            ticks: { color: '#FFFFFF' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: globalPlugins,
                    animation: {
                        x: { // Animate x (width) for horizontal bars
                            type: 'number',
                            easing: 'easeOutQuart',
                            from: (context) => context.chart.scales.x.left, // Start from the left edge of the chart area
                            duration: 700
                        },
                        opacity: { // Animate opacity simultaneously
                            type: 'number',
                            from: 0,
                            to: 1,
                            duration: 700
                        }
                    }
                }
            });
            chartsInitialized.engagementRateChart = true;
        }

        function createVirtualConcertsChart() {
            // Destroy existing chart instance if it exists
            if (charts.virtualConcertsChart) {
                charts.virtualConcertsChart.destroy();
                charts.virtualConcertsChart = null;
            }
            const ctx = document.getElementById('virtualConcertsChart').getContext('2d');
            charts.virtualConcertsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: processLabels(['Marshmello (2019)', 'Travis Scott (2020)', 'The Big Bang (2023)']),
                    datasets: [{
                        label: 'Concurrent Viewers (Millions)',
                        data: [10, 12, 3],
                        backgroundColor: ['#2B78BF', '#B5CBEB', '#F7E598'],
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        y: { // Numerical scale for vertical bars
                            min: 0, // Ensure it starts from 0
                            ticks: { color: '#FFFFFF', beginAtZero: true },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: { // Categorical scale for vertical bars
                            ticks: { color: '#FFFFFF' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: globalPlugins,
                    animation: {
                        y: { // Animate y (height) for vertical bars
                            type: 'number',
                            easing: 'easeOutQuart',
                            from: (context) => context.chart.scales.y.bottom, // Start from the bottom edge of the chart area
                            duration: 700
                        },
                        opacity: { // Animate opacity simultaneously
                            type: 'number',
                            from: 0,
                            to: 1,
                            duration: 700
                        }
                    }
                }
            });
            chartsInitialized.virtualConcertsChart = true;
        }

        function createHallyuWaveChart() {
            // Destroy existing chart instance if it exists
            if (charts.hallyuWaveChart) {
                charts.hallyuWaveChart.destroy();
                charts.hallyuWaveChart = null;
            }
            const ctx = document.getElementById('hallyuWaveChart').getContext('2d');
            charts.hallyuWaveChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: processLabels(['India', 'USA', 'Thailand', 'Turkey', 'Nigeria', 'UK']),
                    datasets: [
                        {
                            label: 'K-Food', /* Changed order for staggered animation */
                            data: [6, 9, 5, 6, 9, 9],
                            fill: true,
                            backgroundColor: 'rgba(43, 120, 191, 0.2)', /* Blue color */
                            borderColor: '#2B78BF',
                            pointBackgroundColor: '#2B78BF',
                        },
                        {
                            label: 'K-Drama', /* Changed order for staggered animation */
                            data: [7, 8, 7, 9, 6, 7],
                            fill: true,
                            backgroundColor: 'rgba(181, 203, 235, 0.2)', /* White/Light Blue color */
                            borderColor: '#B5CBEB',
                            pointBackgroundColor: '#B5CBEB',
                        },
                        {
                            label: 'K-Pop', /* Changed order for staggered animation */
                            data: [9, 6, 9, 5, 4, 6],
                            fill: true,
                            backgroundColor: 'rgba(96, 211, 148, 0.2)', /* Green color */
                            borderColor: '#60D394',
                            pointBackgroundColor: '#60D394',
                        }
                    ]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.2)' },
                            grid: { color: 'rgba(255, 255, 255, 0.2)' },
                            pointLabels: { color: '#FFFFFF', font: { size: 12 } },
                            ticks: {
                                color: '#1A1A1A',
                                backdropColor: 'rgba(255, 255, 255, 0.8)',
                                stepSize: 2
                            }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#FFFFFF' } },
                        tooltip: {
                            callbacks: {
                                title: (ctx) => ctx[0].label
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart',
                        delay: (context) => {
                            // Stagger animation for each dataset in the radar chart
                            let delay = 0;
                            // K-Food (index 0) -> 0ms delay
                            // K-Drama (index 1) -> 100ms delay
                            // K-Pop (index 2) -> 200ms delay
                            if (context.datasetIndex === 0) delay = 0; // K-Food (Blue)
                            else if (context.datasetIndex === 1) delay = 100; // K-Drama (White/Light Blue)
                            else if (context.datasetIndex === 2) delay = 200; // K-Pop (Green)
                            return delay;
                        }
                    }
                }
            });
            chartsInitialized.hallyuWaveChart = true;
        }

        function createPhStreamingChart() {
            // Destroy existing chart instance if it.exists
            if (charts.phStreamingChart) {
                charts.phStreamingChart.destroy();
                charts.phStreamingChart = null;
            }
            const ctx = document.getElementById('phStreamingChart').getContext('2d');
            charts.phStreamingChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: processLabels(['Netflix', 'Other Platforms']),
                    datasets: [{
                        data: [34, 66],
                        backgroundColor: ['#E50914', '#2B78BF'],
                        borderColor: '#282828',
                        borderWidth: 4
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { color: '#FFFFFF' } },
                        tooltip: {
                            callbacks: {
                                title: (ctx) => ctx[0].label
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true,
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            chartsInitialized.phStreamingChart = true;
        }
        
        function createMetaverseMarketChart() {
            // Destroy existing chart instance if it exists
            if (charts.metaverseMarketChart) {
                charts.metaverseMarketChart.destroy();
                charts.metaverseMarketChart = null;
            }
            const ctx = document.getElementById('metaverseMarketChart').getContext('2d');
            charts.metaverseMarketChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: processLabels(['2021', '2030 (Projected)']),
                    datasets: [{
                        label: 'Global Market Value (Trillions USD)',
                        data: [0.04, 1.6],
                        fill: true,
                        borderColor: '#60D394',
                        backgroundColor: 'rgba(96, 211, 148, 0.3)', // Initial fill color
                        tension: 0.1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: globalScales,
                    plugins: globalPlugins,
                    animation: {
                        opacity: { // Animate opacity for the entire dataset
                            type: 'number',
                            from: 0,
                            to: 1,
                            duration: 1000,
                            easing: 'easeInOutQuart'
                        }
                    }
                }
            });
            chartsInitialized.metaverseMarketChart = true;
        }

        function createConsumerValuesChart() {
            // Destroy existing chart instance if it exists
            if (charts.consumerValuesChart) {
                charts.consumerValuesChart.destroy();
                charts.consumerValuesChart = null;
            }
            const ctx = document.getElementById('consumerValuesChart').getContext('2d');
            charts.consumerValuesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: processLabels(['Prefer Experiences', 'Prefer Material Goods']),
                    datasets: [{
                        data: [73, 27],
                        backgroundColor: ['#F7E598', '#2B78BF'],
                        borderColor: '#282828',
                        borderWidth: 4
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            align: 'center',
                            labels: {
                                color: '#FFFFFF',
                                font: {
                                    size: 11,
                                    lineHeight: 1.5
                                },
                                boxWidth: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: (ctx) => ctx[0].label
                            }
                        },
                        title: {
                            display: true,
                            text: 'Consumer Preference Shift (2024)',
                            color: '#FFFFFF',
                            font: { size: 16 }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true,
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            chartsInitialized.consumerValuesChart = true;
        }

        const chartCreationMap = {
            'engagementRateChart': createEngagementRateChart,
            'virtualConcertsChart': createVirtualConcertsChart,
            'hallyuWaveChart': createHallyuWaveChart,
            'phStreamingChart': createPhStreamingChart,
            'metaverseMarketChart': createMetaverseMarketChart,
            'consumerValuesChart': createConsumerValuesChart
        };

        // Intersection Observer for scroll animations
        document.addEventListener('DOMContentLoaded', () => {
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Add 'is-visible' class to trigger CSS animations
                        entry.target.classList.add('is-visible');
                        
                        // Handle chart initialization/re-initialization
                        if (entry.target.classList.contains('chart-section')) {
                            const chartId = entry.target.dataset.chartId;
                            if (chartCreationMap[chartId]) {
                                chartCreationMap[chartId]();
                            }
                        }

                        // Handle stat number animation
                        if (entry.target.querySelector('[data-animate="stat-number"]')) {
                            const statNumbers = entry.target.querySelectorAll('[data-animate="stat-number"]');
                            statNumbers.forEach(num => {
                                num.style.transitionDelay = `0ms`; // No delay for simultaneous
                                num.classList.add('is-visible');
                            });
                        }

                        // Handle flowchart node animation (simultaneous)
                        if (entry.target.classList.contains('flowchart-section')) {
                            const flowchartNodes = entry.target.querySelectorAll('.flowchart-node');
                            flowchartNodes.forEach(node => {
                                node.style.transitionDelay = `0ms`; // No delay for simultaneous
                                node.classList.add('is-visible');
                            });
                        }

                        // Handle timeline item animation (simultaneous)
                        if (entry.target.classList.contains('timeline-section')) {
                            const timelineItems = entry.target.querySelectorAll('.timeline-item');
                            timelineItems.forEach(item => {
                                item.style.transitionDelay = `0ms`; // No delay for simultaneous
                                item.classList.add('is-visible');
                            });
                        }

                    } else {
                        // Remove 'is-visible' class when element leaves viewport
                        entry.target.classList.remove('is-visible');
                        // Reset transition delay and transform for stat numbers when they leave view
                        if (entry.target.querySelector('[data-animate="stat-number"]')) {
                            const statNumbers = entry.target.querySelectorAll('[data-animate="stat-number"]');
                            statNumbers.forEach(num => {
                                num.style.transitionDelay = `0ms`;
                                num.classList.remove('is-visible'); // Ensure opacity and transform reset via CSS
                            });
                        }
                        // Reset transition delay and transform for flowchart nodes
                        if (entry.target.classList.contains('flowchart-section')) {
                            const flowchartNodes = entry.target.querySelectorAll('.flowchart-node');
                            flowchartNodes.forEach(node => {
                                node.style.transitionDelay = `0ms`;
                                node.classList.remove('is-visible'); // Ensure opacity and transform reset via CSS
                            });
                        }
                         // Reset transition delay and transform for timeline items
                        if (entry.target.classList.contains('timeline-section')) {
                            const timelineItems = entry.target.querySelectorAll('.timeline-item');
                            timelineItems.forEach(item => {
                                item.style.transitionDelay = `0ms`;
                                item.classList.remove('is-visible'); // Ensure opacity and transform reset via CSS
                            });
                        }
                    }
                });
            }, observerOptions);

            // Observe elements for general fade-in animation
            document.querySelectorAll('h1, h2, p, .bg-spotify-card:not(.chart-section), .flowchart-section, .timeline-section').forEach(element => {
                observer.observe(element);
            });

            // Observe chart sections for animation re-triggering
            document.querySelectorAll('.chart-section').forEach(element => {
                observer.observe(element);
            });
        });
    </script>
</body>
</html>
